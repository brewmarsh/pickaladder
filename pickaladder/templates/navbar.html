<header class="header">
    <div class="container">
        <nav class="navbar">
            <a href="{{ url_for('user.dashboard') }}" class="navbar-brand" style="display: flex; align-items: center;">
                <img src="{{ url_for('static', filename='pickaladder_logo_64.png') }}" alt="pickaladder logo"
                    style="height: 24px; margin-right: 8px;">
                pickaladder
            </a>
            <div class="navbar-menu">
                {% if g.user %}
                <a href="{{ url_for('user.dashboard') }}"
                    class="nav-link {{ 'active' if request.endpoint == 'user.dashboard' }}">ğŸ“ˆ Dashboard</a>
                <a href="{{ url_for('user.view_community') }}"
                    class="nav-link {{ 'active' if request.endpoint == 'user.view_community' or request.endpoint == 'user.friend_requests' }}"
                    style="position: relative;">
                    ğŸŒ Community
                    {% if incoming_requests_count > 0 %}
                    <span class="notification-badge">{{ incoming_requests_count }}</span>
                    {% endif %}
                </a>
                <a href="{{ url_for('group.view_groups') }}"
                    class="nav-link {{ 'active' if request.endpoint == 'group.view_groups' }}">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ Groups</a>
                <a href="{{ url_for('tournament.list_tournaments') }}"
                    class="nav-link {{ 'active' if request.endpoint == 'tournament.list_tournaments' }}"
                    style="position: relative;">
                    ğŸ¾ Tournaments
                    {% if pending_tournament_invites %}
                    <span class="notification-badge">{{ pending_tournament_invites|length }}</span>
                    {% endif %}
                </a>
                <a href="{{ url_for('match.leaderboard') }}"
                    class="nav-link {{ 'active' if request.endpoint == 'match.leaderboard' }}">ğŸ† Global Leaderboard</a>
                {% else %}
                <div class="desktop-auth-buttons">
                    {% if request.endpoint != 'auth.login' %}
                    <a href="{{ url_for('auth.login') }}" class="btn">Login</a>
                    {% endif %}
                    <a href="{{ url_for('auth.register') }}" class="btn btn-primary">Register</a>
                </div>
                {% endif %}
            </div>
            <div class="navbar-user-controls">
                {% if g.user %}
                <div class="dropdown">
                    <button class="dropbtn">
                        <img src="{{ g.user.avatar_url }}" alt="Profile Picture" class="avatar avatar-sm"
                            onerror="this.onerror=null;this.src='{{ url_for('static', filename='user_icon.png') }}';">
                    </button>
                    <div class="dropdown-content">
                        <a href="{{ url_for('user.view_user', user_id=g.user['uid']) }}">ğŸ‘¤ My Profile</a>
                        <a href="{{ url_for('auth.change_password') }}">ğŸ”‘ Settings / Change Password</a>
                        {% if session.get('is_admin') %}
                        <a href="{{ url_for('admin.admin') }}">ğŸ‘‘ Admin</a>
                        {% endif %}
                        <div class="dropdown-divider"></div>
                        <a href="{{ url_for('auth.logout') }}">ğŸšª Logout</a>
                    </div>
                </div>
                {% else %}
                <div class="dropdown guest-mobile-menu">
                    <div class="dropdown-content">
                        <a href="{{ url_for('auth.login') }}">Login</a>
                        <a href="{{ url_for('auth.register') }}">Register</a>
                    </div>
                </div>
                {% endif %}
                <button class="hamburger-menu">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </div>
        </nav>
    </div>
</header>